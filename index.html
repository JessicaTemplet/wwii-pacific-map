<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Righteous Might: Victory over Japan in WWII</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>

  <style>
    :root{--map-height:94vh}
    body{margin:0;font-family:system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;background:#f8f9fa;color:#111}
    header{padding:12px 16px;text-align:center}
    header h1{margin:0;font-size:20px}
    #map{width:100%;height:var(--map-height);box-shadow:0 2px 10px rgba(0,0,0,0.06)}
    
    /* Fixed legend positioning - bottom right with better visibility */
    .legend{
      position: absolute !important;
      bottom: 20px !important;
      right: 20px !important;
      background: rgba(255,255,255,0.95) !important;
      padding: 12px !important;
      border-radius: 8px !important;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
      font-size: 12px !important;
      line-height: 1.4 !important;
      max-width: 220px !important;
      z-index: 1000 !important;
      border: 1px solid rgba(0,0,0,0.1) !important;
    }
    .legend-title{font-weight:bold;margin-bottom:8px;color:#333;font-size:13px}
    .legend-row{display:flex;align-items:center;margin-bottom:5px}
    .legend-swatch{width:16px;height:12px;margin-right:8px;border-radius:3px;border:1px solid rgba(0,0,0,0.2);flex-shrink:0}
    .legend-symbol{width:16px;height:16px;margin-right:8px;display:inline-block;vertical-align:middle;flex-shrink:0}
    .legend-text{font-size:11px;color:#333}
    .legend-section{margin-bottom:8px}
    .legend-section-title{font-weight:bold;font-size:11px;color:#555;margin-bottom:3px}
    
    /* event count badge */
    #countBadge{position:fixed;right:14px;top:14px;background:#1F6FEB;color:#fff;padding:6px 10px;border-radius:999px;font-size:13px;box-shadow:0 2px 8px rgba(0,0,0,0.12);z-index:9999}
    a.source{color:#1F6FEB;text-decoration:none}
    
    /* Custom marker styles for numbered circles */
    .numbered-marker {
      background: #1F6FEB;
      border: 2px solid #fff;
      border-radius: 50%;
      color: #fff;
      font-weight: bold;
      text-align: center;
      font-size: 10px;
      line-height: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    .numbered-marker.japan { background: #D0021B; }
    .numbered-marker.joint { background: #7A3EE6; }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      .legend { 
        max-width: 180px !important; 
        font-size: 11px !important;
        bottom: 10px !important;
        right: 10px !important;
      }
      .legend-text { font-size: 10px; }
      .numbered-marker { font-size: 9px; }
      header h1 { font-size: 18px; }
    }
  </style>
</head>
<body>
  <header>
    <h1>Righteous Might: Victory over Japan in World War II</h1>
  </header>

  <div id="map" aria-label="WWII Pacific map"></div>

  <div id="countBadge" aria-live="polite">Events: â€”</div>

  <script src="map.js"></script>

</body>
</html>
